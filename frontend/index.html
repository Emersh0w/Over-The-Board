<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="home.title">Over the Board - Dashboard</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('frontend', path='/styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('frontend', path='/mobile-enhancements.css') }}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('frontend', path='/apple-touch-icon.png') }}">
    <link rel="icon" type="image.png" sizes="32x32" href="{{ url_for('frontend', path='/favicon-32x32.png') }}">
    <link rel="icon" type="image.png" sizes="16x16" href="{{ url_for('frontend', path='/favicon-16x16.png') }}">
    <link rel="manifest" href="frontend/site.webmanifest">
</head>
<body>

<script>
    // Checks for localhost or render
    document.addEventListener("DOMContentLoaded", () => {
    const apiLinks = document.querySelectorAll(".api-link");

    const isLocalhost =
      window.location.hostname === "localhost" ||
      window.location.hostname === "127.0.0.1";

    const baseUrl = isLocalhost
      ? "http://localhost:8000"
      : "https://over-the-board.onrender.com";
      
    window.API_BASE_URL = "{{ API_BASE_URL }}";

    apiLinks.forEach(link => {
        const path = link.getAttribute("data-path");

        // Só define o href se houver data-path e for relativo
        if (path && !path.startsWith("http")) {
            link.href = baseUrl + path;
        }
    });
  });
</script>

<!-- Header -->
    <header class="header">
        <div class="container-fluid px-3">
            <nav class="navbar navbar-expand-lg">
                <div class="navbar-brand d-flex align-items-center">
                    <i class="fas fa-chess-king me-2"></i>
                    <h1 class="mb-0 d-none d-sm-block" data-i18n="home.header.name" >Over the Board</h1>
                    <h1 class="mb-0 d-sm-none fs-6" data-i18n="home.name">Chess API</h1>
                </div>
                
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <i class="fas fa-bars"></i>
                </button>
                
                <div class="collapse navbar-collapse" id="navbarNav">
                    <div class="navbar-nav ms-auto">
                        <button class="nav-btn active" data-section="home">
                            <i class="fas fa-home"></i> <span data-i18n="header.home">Início</span>
                        </button>
                        <button class="nav-btn" data-section="tournaments">
                            <i class="fas fa-trophy"></i> <span data-i18n="header.tournaments">Torneios</span>
                        </button>
                        <button class="nav-btn" data-section="players">
                            <i class="fas fa-users"></i> <span data-i18n="header.players">Jogadores</span>
                        </button>
                        <button class="nav-btn" data-section="news">
                            <i class="fas fa-newspaper"></i> <span data-i18n="header.news">Notícias</span>
                        </button>
                        <button class="nav-btn" data-section="announcements">
                            <i class="fas fa-bullhorn"></i> <span data-i18n="header.announcements">Comunicados</span>
                        </button>
                        <button class="nav-btn" data-section="admin">
                            <i class="fas fa-cog"></i> <span data-i18n="header.admin">Admin</span>
                        </button>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <div class="container-fluid px-3">
            <!-- Loading Overlay -->
            <div class="loading-overlay" id="loadingOverlay">
                <div class="spinner"></div>
                <p data-i18n="generic.loading">Carregando dados...</p>
            </div>

            <!-- Home Section -->
            <section id="home" class="section active">
                <div class="hero text-center">
                    <h2 class="mb-3" data-i18n="home.welcome">Bem-vindo à Over the Board</h2>
                    <p class="mb-4" data-i18n="home.subTitle">API moderna e robusta para consulta de informações sobre xadrez da CBX</p>
                    <div class="row g-3 mb-4">
                        <div class="col-6 col-md-3">
                            <div class="stat-card text-center p-3">
                                <i class="fas fa-server mb-2"></i>
                                <h3 id="apiStatus" class="fs-6 mb-1" data-i18n="home.verifying">Verificando...</h3>
                                <p class="small mb-0" data-i18n="home.apiStatus">Status da API</p>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="stat-card text-center p-3">
                                <i class="fas fa-database mb-2"></i>
                                <h3 id="cacheSize" class="fs-6 mb-1">0</h3>
                                <p class="small mb-0"><span data-i18n="home.cacheTitle"> Itens em Cache</span></p>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="stat-card text-center p-3">
                                <i class="fas fa-chart-line mb-2"></i>
                                <h3 class="fs-6 mb-1">1.0.3</h3>
                                <p class="small mb-0" data-i18n="home.versionTitle">Versão Atual</p>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="stat-card text-center p-3">
                                <i class="fas fa-clock mb-2"></i>
                                <h3 id="currentTime" class="fs-6 mb-1">--:--</h3>
                                <p class="small mb-0" data-i18n="home.currentTime">Horário</p>
                            </div>
                        </div>
                    </div>
                    <div class="d-flex flex-wrap gap-2 justify-content-center">
                        <button class="btn btn-primary" onclick="showSection('tournaments')">
                            <i class="fas fa-trophy"></i> <span data-i18n="home.showTournaments">Ver Torneios</span>
                        </button>
                        <button class="btn btn-secondary" onclick="showSection('players')">
                            <i class="fas fa-users"></i> <span data-i18n="home.showPlayers">Buscar Jogadores</span>
                        </button>
                        <a class="api-link btn btn-outline-primary" data-path="/docs" href="#">
                            <i class="fas fa-book"></i> <span data-i18n="home.documentation">Documentação</span>
                        </a>
                        <div class="language-selector-wrapper">
                            <select onchange="loadLocale(this.value)" id="languageSelector" class="form-select auto-width">
                                <option value="pt" data-i18n="">Português</option>
                                <option value="en" data-i18n="">English</option>
                            </select>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tournaments Section -->
            <section id="tournaments" class="section">
                <div class="section-header text-center mb-4">
                    <h2><i class="fas fa-trophy"></i>
                        <span data-i18n="tournaments.title"> Torneios CBX</span></h2>
                    <p data-i18n="tournaments.subTitle">Consulte torneios por ano e mês</p>
                </div>
                
                <div class="row g-3 mb-4">
                    <div class="col-12 col-sm-6 col-md-3">
                        <label for="tournamentYear" class="form-label" data-i18n="tournaments.year">Ano:</label>
                        <select id="tournamentYear" class="form-select">
                            <option value="2025" data-i18n="tournaments.year.2025">2025</option>
                            <option value="2024" data-i18n="tournaments.year.2024">2024</option>
                            <option value="2023" data-i18n="tournaments.year.2023">2023</option>
                        </select>
                    </div>
                    <div class="col-12 col-sm-6 col-md-3">
                        <label for="tournamentMonth" class="form-label" data-i18n="tournaments.month">Mês:</label>
                        <select id="tournamentMonth" class="form-select">
                            <option value="" data-i18n="tournaments.month.all">Todos</option>
                            <option value="1" data-i18n="tournaments.month.january">Janeiro</option>
                            <option value="2" data-i18n="tournaments.month.february">Fevereiro</option>
                            <option value="3" data-i18n="tournaments.month.march">Março</option>
                            <option value="4" data-i18n="tournaments.month.april">Abril</option>
                            <option value="5" data-i18n="tournaments.month.may">Maio</option>
                            <option value="6" data-i18n="tournaments.month.june">Junho</option>
                            <option value="7" data-i18n="">Julho</option>
                            <option value="8" data-i18n="tournaments.month.august">Agosto</option>
                            <option value="9" data-i18n="tournaments.month.september">Setembro</option>
                            <option value="10" data-i18n="tournaments.month.october">Outubro</option>
                            <option value="11" data-i18n="tournaments.month.november">Novembro</option>
                            <option value="12" data-i18n="tournaments.month.december">Dezembro</option>
                        </select>
                    </div>
                    <div class="col-12 col-sm-6 col-md-3">
                        <label for="tournamentLimit" class="form-label" data-i18n="tournaments.limitTitle">Limite:</label>
                        <select id="tournamentLimit" class="form-select">
                            <option value="10" data-i18n="tournaments.limit.10">10</option>
                            <option value="20" data-i18n="tournaments.limit.20">20</option>
                            <option value="50" data-i18n="tournaments.limit.50">50</option>
                            <option value="100" data-i18n="tournaments.limit.100">100</option>
                        </select>
                    </div>
                    <div class="col-12 col-sm-6 col-md-3 d-flex align-items-end">
                        <button class="btn btn-primary w-100" onclick="searchTournaments()">
                            <i class="fas fa-search"></i> <span data-i18n="tournaments.search">Buscar</span>
                        </button>
                    </div>
                </div>

                <div id="tournamentsResults" class="results-container">
                    <div class="empty-state text-center">
                        <i class="fas fa-trophy"></i>
                        <p data-i18n="tournaments.searchDescription">Use os filtros acima para buscar torneios</p>
                    </div>
                </div>
            </section>

            <!-- Players Section -->
            <section id="players" class="section">
                <div class="section-header text-center mb-4">
                    <h2><i class="fas fa-users"></i>
                        <span data-i18n="players.title"> Jogadores Xadrez</span></h2>
                    <p data-i18n="players.subTitle">Consulte jogadores por estado</p>
                </div>
                
                <div class="row g-3 mb-4">
                    <div class="col-12 col-md-6">
                        <label for="playerUF" class="form-label" data-i18n="players.stateTitle">Estado (UF):</label>
                        <select id="playerUF" class="form-select">
                            <option value="SP">São Paulo (SP)</option>
                            <option value="RJ">Rio de Janeiro (RJ)</option>
                            <option value="MG">Minas Gerais (MG)</option>
                            <option value="RS">Rio Grande do Sul (RS)</option>
                            <option value="PR">Paraná (PR)</option>
                            <option value="SC">Santa Catarina (SC)</option>
                            <option value="BA">Bahia (BA)</option>
                            <option value="GO">Goiás (GO)</option>
                            <option value="PE">Pernambuco (PE)</option>
                            <option value="CE">Ceará (CE)</option>
                            <option value="DF">Distrito Federal (DF)</option>
                            <option value="ES">Espírito Santo (ES)</option>
                            <option value="PB">Paraíba (PB)</option>
                            <option value="RN">Rio Grande do Norte (RN)</option>
                            <option value="AL">Alagoas (AL)</option>
                            <option value="SE">Sergipe (SE)</option>
                            <option value="MA">Maranhão (MA)</option>
                            <option value="PI">Piauí (PI)</option>
                            <option value="MT">Mato Grosso (MT)</option>
                            <option value="MS">Mato Grosso do Sul (MS)</option>
                            <option value="AC">Acre (AC)</option>
                            <option value="RO">Rondônia (RO)</option>
                            <option value="RR">Roraima (RR)</option>
                            <option value="AM">Amazonas (AM)</option>
                            <option value="AP">Amapá (AP)</option>
                            <option value="PA">Pará (PA)</option>
                            <option value="TO">Tocantins (TO)</option>
                        </select>
                    </div>
                    <div class="col-12 col-md-3">
                        <label for="playerPages" class="form-label" data-i18n="players.pagesTitle">Páginas:</label>
                        <select id="playerPages" class="form-select">
                            <option value="1" data-i18n="players.pages.1">1</option>
                            <option value="2" data-i18n="players.pages.2">2</option>
                            <option value="3" data-i18n="players.pages.3">3</option>
                            <option value="5" data-i18n="players.pages.5">5</option>
                            <option value="10" data-i18n="players.pages.10">10</option>
                        </select>
                    </div>
                    <div class="col-12 col-md-3 d-flex align-items-end">
                        <button class="btn btn-primary w-100" onclick="searchPlayers()">
                            <i class="fas fa-search"></i> <span data-i18n="players.search">Buscar</span>
                        </button>
                    </div>
                </div>

                <div id="playersResults" class="results-container">
                    <div class="empty-state text-center">
                        <i class="fas fa-users"></i>
                        <p data-i18n="players.searchDescription">Use os filtros acima para buscar jogadores</p>
                    </div>
                </div>
            </section>

            <!-- News Section -->
            <section id="news" class="section">
                <div class="section-header text-center mb-4">
                    <h2><i class="fas fa-newspaper"></i>
                        <span data-i18n="news.title"> Notícias CBX</span></h2>
                    <p data-i18n="news.subTitle">Últimas notícias da Confederação Brasileira de Xadrez</p>
                </div>
                
                <div class="row g-3 mb-4">
                    <div class="col-12 col-md-6">
                        <label for="newsPages" class="form-label" data-i18n="news.pagesTitle">Páginas:</label>
                        <select id="newsPages" class="form-select">
                            <option value="1" data-i18n="news.pages.1">1</option>
                            <option value="2" data-i18n="news.pages.2">2</option>
                            <option value="3" data-i18n="news.pages.3">3</option>
                            <option value="5" data-i18n="news.pages.5">5</option>
                        </select>
                    </div>
                    <div class="col-12 col-md-6 d-flex align-items-end">
                        <button class="btn btn-primary w-100" onclick="searchNews()">
                            <i class="fas fa-search"></i> <span data-i18n="news.search">Buscar Notícias</span>
                        </button>
                    </div>
                </div>

                <div id="newsResults" class="results-container">
                    <div class="empty-state text-center">
                        <i class="fas fa-newspaper"></i>
                        <p data-i18n="news.searchDescription">Clique em "Buscar Notícias" para carregar as últimas notícias</p>
                    </div>
                </div>
            </section>

            <!-- Announcements Section -->
            <section id="announcements" class="section">
                <div class="section-header text-center mb-4">
                    <h2><i class="fas fa-bullhorn"></i>
                        <span data-i18n="announcements.title"> Comunicados Xadrez</span></h2>
                    <p data-i18n="announcements.subTitle">Comunicados oficiais da Confederação Brasileira de Xadrez</p>
                </div>
                
                <div class="row g-3 mb-4">
                    <div class="col-12 col-md-6">
                        <label for="announcementPages" class="form-label" data-i18n="">Páginas:</label>
                        <select id="announcementPages" class="form-select">
                            <option value="1" data-i18n="announcements.pages.1">1</option>
                            <option value="2" data-i18n="announcements.pages.2">2</option>
                            <option value="3" data-i18n="announcements.pages.3">3</option>
                            <option value="5" data-i18n="announcements.pages.5">5</option>
                        </select>
                    </div>
                    <div class="col-12 col-md-6 d-flex align-items-end">
                        <button class="btn btn-primary w-100" onclick="searchAnnouncements()">
                            <i class="fas fa-search"></i> <span data-i18n="announcements.search">Buscar Comunicados</span>
                        </button>
                    </div>
                </div>

                <div id="announcementsResults" class="results-container">
                    <div class="empty-state text-center">
                        <i class="fas fa-bullhorn"></i>
                        <p data-i18n="announcements.searchDescription">Clique em "Buscar Comunicados" para carregar os comunicados</p>
                    </div>
                </div>
            </section>

            <!-- Admin Section -->
            <section id="admin" class="section">
                <div class="section-header text-center mb-4">
                    <h2><i class="fas fa-cog"></i>
                        <span data-i18n="admin.title"> Administração</span></h2>
                    <p data-i18n="admin.subTitle">Gerenciamento da API e cache</p>
                </div>
                
                <div class="row g-4 mb-4">
                    <div class="col-12 col-md-6 col-lg-4">
                        <div class="admin-card h-100 p-3">
                            <h3 class="h5"><i class="fas fa-heartbeat"></i>
                                <Span data-i18n="admin.statusTitle"> Status da API</Span>
                            </h3>
                            <div id="healthStatus" class="status-indicator mb-3">
                                <span class="status-dot"></span>
                                <span class="status-text" data-i18n="admin.statusVerifying">Verificando...</span>
                            </div>
                            <button class="btn btn-outline-primary btn-sm w-100" onclick="checkHealth()">
                                <i class="fas fa-sync"></i> <span data-i18n="admin.statusCheck">Verificar Status</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="col-12 col-md-6 col-lg-4">
                        <div class="admin-card h-100 p-3">
                            <h3 class="h5"><i class="fas fa-database"></i>
                                <span data-i18n="admin.cacheTitle"> Cache</span></h3>
                            <p class="mb-3" data-i18n="admin.cacheSubTitle">Itens em cache: <span id="adminCacheSize" data-i18n="home.cacheCount">0</span></p>
                            <div class="d-grid gap-2">
                                <button class="btn btn-outline-primary btn-sm" onclick="getCacheStats()">
                                    <i class="fas fa-chart-bar"></i> <span data-i18n="admin.cacheStats">Ver Stats</span>
                                </button>
                                <button class="btn btn-outline-danger btn-sm" onclick="clearCache()">
                                    <i class="fas fa-trash"></i> <span data-i18n="admin.cacheClear">Limpar Cache</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-12 col-lg-4">
                        <div class="admin-card h-100 p-3">
                            <h3 class="h5"><i class="fas fa-link" aria-hidden="true"></i>
                                <span data-i18n="admin.linksTitle">Links Úteis</span></h3>
                            <div class="d-grid gap-2">
                                <a class="api-link btn btn-outline-primary" data-path="/docs" href="#">
                                    <i class="fas fa-book"></i> <span data-i18n="admin.link.swagger">Swagger Docs</span>
                                </a>
                                <a class="api-link btn btn-outline-primary" data-path="/redocs" href="#">
                                    <i class="fas fa-file-alt"></i> <span data-i18n="admin.link.redoc">ReDoc</span>
                                </a>
                                <a class="api-link btn btn-outline-primary" href="https://github.com/Emersh0w/Chess-Tournaments-API" target="_blank" rel="noopener noreferrer">
                                    <i class="fa-brands fa-github"></i> <span data-i18n="admin.link.github">GitHub</span>
                                </a>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="admin-card p-3">
                    <h3 class="h5" data-i18n="admin.apiResponse"><i class="fas fa-terminal"></i> API Response</h3>
                    <pre id="apiResponse" class="code-block" data-i18n="admin.apiResponse.none">Nenhuma resposta ainda...</pre>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer mt-5">
        <div class="container-fluid px-3 text-center">
            <p class="mb-1" data-i18n="footer.title">&copy; 2025 Over the Board - Feito com ❤️ para a comunidade brasileira de xadrez</p>
            <p class="mb-0 small" data-i18n="footer.subTitle">API não oficial da CBX</p>
        </div>
    </footer>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container position-fixed top-0 end-0 p-3"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('frontend', path='/script.js') }}"></script>
    <script src="{{ url_for('frontend', path='/i18n.js') }}"></script>
</body>
</html>
